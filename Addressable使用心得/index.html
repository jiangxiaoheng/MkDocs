<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Addressable使用心得 - My Docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Addressable\u4f7f\u7528\u5fc3\u5f97";
        var mkdocs_page_input_path = "Addressable\u4f7f\u7528\u5fc3\u5f97.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> My Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Python%20%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/">Python 虚拟环境</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Django%2BTornado%2BNginx/">Django+Tornado+Nginx</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../django%E8%AF%AD%E5%8F%A5/">django语句</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../docker/">docker</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ExpressNode.Js/">ExpressNode.Js</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../HTML%EF%BC%8CCSS%E8%AF%AD%E5%8F%A5/">HTML，CSS语句</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Linux%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Linux 常用命令</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Linux%E8%AF%AD%E5%8F%A5%E5%91%BD%E4%BB%A4/">Linux语句命令</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Nginx/">Nginx</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../PHP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E2%80%94%E2%80%94Composer%20%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">PHP开发环境——Composer 的安装与使用</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Python%20%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/">Python 虚拟环境</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../SQL%E8%AF%AD%E5%8F%A5/">SQL语句</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../UnityWebRequest%20%E4%B8%8E%20Web%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%9A%E8%AE%AF/">UnityWebRequest 与 Web 服务器通讯</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2%E8%A7%84%E5%88%92/">网站部署规划</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Addressable使用心得</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_1">快速入门</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#catalogs">Catalogs 资源表</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_2">依赖</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">热更新</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">实例化</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bug">Bug:</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">My Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Addressable使用心得</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="addressable"><a href="https://www.cnblogs.com/Persona/p/12611288.html">Addressable使用心得</a></h2>
<p>Addressable继承了assetbundle 在unity2017之后官方开发的资源验证流程，做到在游戏运行中读取和更新资源不用关心bundle以及hash。</p>
<p>不是初级教程，初级教程网上很多，这里算是补全一些使用的重点和细节</p>
<p>addressable group 这个工具 去bilibili看教程 很快就会了，这里主要是笔者自己的使用心得</p>
<h3 id="_1"><strong>快速入门</strong></h3>
<p>Addressables.InitializeAsync; 初始化</p>
<p>Addressables.CheckForCatalogUpdates;检查网络端的资源表</p>
<p>Addressables.UpdateCatalogs 下载对应资源表</p>
<p>Addressables.GetDownloadSizeAsync 检查要下载的资源所在的bundle还有依赖的bunlde的大小</p>
<p>Addressables.DownloadDependenciesAsync 下载资源和依赖的bundle</p>
<p>Addressables. LoadAssetAsync 从加载资源（具体资源同步流程看资源表章节）</p>
<p>AssetReference 可以直接用于选择加入addressable groups里的物体</p>
<p>简单的资源加载和更新函数都列出来了，其他unload的资源管理的自己琢磨把，我也没琢磨过。</p>
<p>下面是Addressable的新特性</p>
<h3 id="catalogs"><strong>Catalogs</strong> <strong>资源表</strong></h3>
<p>Addressable好在catalogs，也难在catalogs, catalogs很重要，所有资源都围着catalogs.</p>
<p>基本上如果出现了难以理解的错误，不是catalogs和资源对不上，就是catalogs没下到。</p>
<p>官方将bundle的hash还有bundle里的依赖全写在catalogs里。</p>
<p>Catalogs是一张资源表，它在你build bundle的时候创建，对整个Addressable极为重要.</p>
<p>游戏在用Addressable加载资源的时候会根据资源地址检测资源在哪个bundle，然后看看当前bundle是否存在，不存在就上网下，然后检查bundle自身的hash直和catalogs里的是否一致，一致就直接读取本地资源，不一致就上网下,下不到就报错，你有老资源也不会读取。它只认资源表</p>
<p>当你打开build remote catalogs，就支持了网络更新资源表。</p>
<p>而不打开build remote catalogs, 可以下网络的资源但是不能热更，这里说的是出包的之后，就只能通过本地的catalogs下载固定的资源，并且下的时候还会校对hash，crc，你替换资源也没用，尝试关闭hash，crc会出错。所以不用想着用addressable系统去更新资源表里没有的资源了，要想那么做，只能另外用assetbundle</p>
<p>如果你不激活disable catalog update on startup，那么每当你第一次初始化Addressable. InitializeAsync 的时候，(如果你不调用 InitalizeAsync,那你用Addressable的任意功能依然都会自动初始化)会自动上网拉取资源表，如果你关闭自动拉取，那么你得用CheckForCatalogUpdates和UpdateCatalogs去主动下载资源表。</p>
<h3 id="_2"><strong>依赖</strong></h3>
<p>GetDownloadSizeAsync和DownloadDependenciesAsync 里面参数是具体的资源地址而不是bundle的组名,网上教程都没说清楚。</p>
<p>如果本地有依赖对应的资源，就算再其他bundle里，也不用你去主动去管理。直接实例化就行</p>
<p>但是，如果那些依赖在本地没有资源，你不使用DownloadDependenciesAsync无法自动下载其他依赖的bundle</p>
<p>DownloadDependenciesAsync多次使用也没效果，本地资源表和资源对的上它不会下东西</p>
<p>Build Bundle的时候会自动将需要依赖的次级资源加入到对应的bundle里，比如，如果你一个group里有个cube.prefab,cube上有材质球和贴图，而你并没有将材质球和题图加入到bundle列表里。它打包的时候会自动将材质球和贴图加进去。如果你材质球和贴图已经在其他bundle group里了，那么不会重复，资源永远只有一份。所以你需要DownloadDependenciesAsync确保所有依赖的bundle都在本地。</p>
<h3 id="_3"><strong>热更新</strong></h3>
<p>热更新需要用到check for content update resdriction,你每次build bundle的时候它都会更新，当你需要热更新的时候，使用check for content update resdriction, 去选一个bin文件，它会告诉你相对上一次的改动，是否有本地资源在列，然后自动把本地资源提出来新建一个组，这时候你不用build，build是完全重新构建，你需要增量更新 update previous build 去选那个bin文件。运行一下它会打增量包。</p>
<h3 id="_4"><strong>实例化</strong></h3>
<p>不要直接InstantiateAsync 要先load出来再instantiate，不要因为异步的关系，有可能导致你关掉运行模式回到编辑模式后，实例化依然再继续，然后就出现在你场景里了</p>
<h3 id="bug">Bug:</h3>
<p>WaitForCompletion 不会自动初始化, 进入游戏自己卡死, 需要手动初始化Addressables.InitializeAsync; (可以用async await 解决)</p>
<p>1.7.4资源表如果开远程，那么就算设定了初始化不检测，依然会连一次网络检测；</p>
<p>DownloadDependenciesAsync 有时候速度太快 它的task会变空，在await导致报错，要处理一下。</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2%E8%A7%84%E5%88%92/" class="btn btn-neutral float-left" title="网站部署规划"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2%E8%A7%84%E5%88%92/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
